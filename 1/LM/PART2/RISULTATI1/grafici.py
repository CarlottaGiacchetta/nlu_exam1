import matplotlib.pyplot as plt

# Data
data = {
    "lr = 5": [
        119.51969730423885, 119.8452770105312, 117.37524092733238, 119.55404018378971,
        118.2622434807027, 120.07825116724003, 119.95863731234148, 121.82691348134652,
        119.36576092077972, 121.80258820085349, 122.05429190620524, 119.50189019799679
    ],
    "lr = 10": [
        124.23274972538509, 121.34701142015311, 117.4011361983363, 124.37560366676661,
        124.79135784881024, 122.45823455967523, 118.80555919600575, 117.64165383927036,
        128.96411473465676, 118.85362601757735, 119.06320184486711, 113.2681705349391
    ],
    "lr = 15": [
        135.2770355640383, 136.22441717495542, 132.59207758547217, 143.977432512522,
        132.181337909664, 127.0398648422587, 138.80529047541972, 135.9638995937352,
        119.20542879034937, 136.06314530725373, 139.828116422943, 117.50038469141218
    ]
}

data = {
    "lr = 5": [
        107.66053473610383, 108.53505914744093, 107.7570423093331, 109.95447907161235,
        109.00586837142956, 108.116517685029, 110.28954575575877, 111.51893009541939,
        109.9359701757533, 109.3005323072523, 110.07804429075331, 109.76334885334117
    ],
    "lr = 10": [
        110.66340866280456, 111.38457921489157, 115.09848925868862, 109.84179867732976,
        109.30564284752934, 109.11650804922171, 109.5124097708001, 108.85282829232989,
        110.19933525174486, 110.42597941232805, 109.55937486424504, 108.83953008919963
    ],
    "lr = 15": [
        117.6747369222223, 122.36658601501655, 118.63448325897782, 116.81865574084242,
        120.20500923420839, 120.26578958283663, 113.0716809703376, 115.20553336101999,
        111.3431839579469, 115.96828428188475, 119.3941087636163, 111.24002616740836
    ]
}

# Plot
fig, ax = plt.subplots(figsize=(10, 6))
for key, values in data.items():
    ax.plot(values, marker='o', label=key)
    
ax.set_xlabel('runs')
ax.set_ylabel('Perplexity')
ax.set_title('Test Perplexity over multiple runs using different parameters')
ax.legend()
plt.grid(True)
plt.show()